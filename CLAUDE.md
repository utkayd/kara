# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is **Kara**, a Neovim colorscheme/theme built on the Lush framework. It's a Lua-based theme that provides syntax highlighting and UI element styling for Neovim.

## Architecture

### Two-Implementation Approach

The theme has two separate implementations:

1. **Simple Implementation** (`lua/kara/init.lua`): A standalone, minimal theme that directly sets highlight groups using `vim.api.nvim_set_hl()`. This is the main implementation that users should interact with via `require("kara").setup()`.

2. **Lush-based Implementation** (`lua/kara/test.lua`): An auto-generated Lush spec containing comprehensive highlight group definitions. This is a large file (~52k tokens) generated by the Lush framework and should be treated as reference material or for advanced theme development.

### File Structure

- `colors/kara.lua`: The colorscheme entry point that Neovim loads. Simply calls `require("kara").setup()`
- `lua/kara/init.lua`: Main module with color palette and `setup()` function
- `lua/kara/test_colors.lua`: Extracted color palette with semantic color names (reference file)
- `lua/kara/test.lua`: Auto-generated Lush spec (large, reference file)

### Color System

The theme uses a dark color palette defined in `lua/kara/init.lua:3-15`:
- Background colors: `bg` (#191B20), `bg2` (#1E2027)
- Semantic colors: `red`, `green`, `blue`, `yellow`, `orange`, `purple`, `cyan`
- UI colors: `fg` (white), `gray`

The `test_colors.lua` file contains an extensive palette with fine-grained color variations (background shades, foreground shades, color gradients) that can be used for theme expansion.

### Customization API

The `setup()` function in `lua/kara/init.lua:17-62` accepts an optional `opts` table with an `on_highlights` callback:

```lua
require("kara").setup({
  on_highlights = function(highlights, colors)
    -- Modify highlights table here
    highlights.Normal.bg = "#000000"
  end
})
```

This callback receives:
- `highlights`: Table of all highlight group definitions
- `colors`: The color palette table

## Plugin Support

The theme includes specific support for:
- **Snacks.nvim**: Dashboard, Picker, and various UI components
- **TreeSitter**: Modern syntax highlighting via `@variable`, `@keyword`, `@function`, etc.

## Development Commands

### Testing the Theme

To test changes to the theme in Neovim:
```vim
:luafile %                    " Reload current Lua file
:colorscheme kara             " Apply the colorscheme
:Lushify                      " If working with test.lua (requires Lush)
```

### Working with Lush

The `test.lua` file was auto-generated by Lush. If you need to regenerate or modify it:
1. Open `lua/kara/test.lua` in Neovim
2. Run `:Lushify` to enable live preview
3. Search `/Normal` to find the Normal group and edit colors
4. Lush provides real-time preview of changes

## Key Implementation Details

- The theme uses Neovim's native highlight API (`vim.api.nvim_set_hl`) rather than legacy `:highlight` commands
- All highlight groups are set in namespace 0 (global namespace)
- TreeSitter groups use the modern `@` prefix convention (e.g., `@variable` not `TSVariable`)
- The simple implementation focuses on essential groups while the Lush implementation provides comprehensive coverage
